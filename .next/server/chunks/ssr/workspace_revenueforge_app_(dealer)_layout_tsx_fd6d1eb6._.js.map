{"version":3,"sources":["../../../../../../workspace/revenueforge/app/%28dealer%29/layout.tsx"],"sourcesContent":["'use client';\n\nimport { useEffect, useState } from 'react';\nimport { useRouter, usePathname } from 'next/navigation';\nimport { useAuth } from '@/lib/auth-context';\n\nexport default function DealerLayout({\n  children,\n}: {\n  children: React.ReactNode;\n}) {\n  const router = useRouter();\n  const pathname = usePathname();\n  const { isAuthenticated, isLoading: authLoading, user, logout } = useAuth();\n  const [isLoading, setIsLoading] = useState(true);\n\n  useEffect(() => {\n    // Wait for auth to initialize\n    if (!authLoading) {\n      // Check if user is a dealer or has dealer access\n      const isDealer = user?.role === 'dealer' || user?.role === 'admin';\n      \n      if (!isAuthenticated && pathname !== '/dealer/login') {\n        router.push('/dealer/login');\n      } else if (isAuthenticated && !isDealer && pathname !== '/dealer/login') {\n        // Non-dealer users should not access dealer pages\n        router.push('/login');\n      }\n      setIsLoading(false);\n    }\n  }, [isAuthenticated, authLoading, pathname, router, user]);\n\n  if (isLoading || authLoading) {\n    return (\n      <div className=\"min-h-screen bg-zinc-50 flex items-center justify-center\">\n        <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-zinc-900\"></div>\n      </div>\n    );\n  }\n\n  const handleLogout = async () => {\n    await logout();\n    router.push('/dealer/login');\n  };\n\n  const navItems = [\n    { href: '/dealer', label: 'Dashboard', icon: 'ðŸ“Š' },\n    { href: '/dealer/products', label: 'Products', icon: 'ðŸ“¦' },\n    { href: '/dealer/orders', label: 'Orders', icon: 'ðŸ›’' },\n    { href: '/dealer/commissions', label: 'Commissions', icon: 'ðŸ’°' },\n  ];\n\n  // Show sidebar only when authenticated as dealer\n  const showSidebar = isAuthenticated && (user?.role === 'dealer' || user?.role === 'admin');\n\n  return (\n    <div className=\"min-h-screen bg-zinc-50\">\n      {/* Top Navigation */}\n      <nav className=\"bg-white border-b border-zinc-200 sticky top-0 z-50\">\n        <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8\">\n          <div className=\"flex justify-between items-center h-16\">\n            <div className=\"flex items-center gap-2\">\n              <div className=\"w-8 h-8 bg-zinc-900 rounded-lg flex items-center justify-center\">\n                <span className=\"text-white font-bold text-sm\">RF</span>\n              </div>\n              <div className=\"hidden sm:block\">\n                <span className=\"font-semibold text-zinc-900 text-lg\">RevenueForge</span>\n                <span className=\"text-zinc-400 mx-2\">â€¢</span>\n                <span className=\"text-zinc-600 text-sm\">Dealer Portal</span>\n              </div>\n            </div>\n            \n            {showSidebar && (\n              <div className=\"flex items-center gap-4\">\n                <div className=\"hidden sm:flex items-center gap-2 text-sm text-zinc-600\">\n                  <div className=\"w-8 h-8 bg-zinc-200 rounded-full flex items-center justify-center text-zinc-700 font-semibold text-xs\">\n                    {user?.name?.split(' ').map(n => n[0]).join('').toUpperCase().slice(0, 2) || 'DP'}\n                  </div>\n                  <span>{user?.name || 'Dealer Partner'}</span>\n                </div>\n                <button\n                  onClick={handleLogout}\n                  className=\"text-sm text-zinc-600 hover:text-zinc-900 transition-colors\"\n                >\n                  Logout\n                </button>\n              </div>\n            )}\n          </div>\n        </div>\n      </nav>\n\n      {/* Sidebar Navigation (Desktop) */}\n      {showSidebar && (\n        <div className=\"flex\">\n          <aside className=\"hidden lg:block w-64 bg-white border-r border-zinc-200 min-h-[calc(100vh-4rem)] sticky top-16\">\n            <nav className=\"p-4 space-y-1\">\n              {navItems.map((item) => {\n                const isActive = pathname === item.href;\n                return (\n                  <a\n                    key={item.href}\n                    href={item.href}\n                    className={`flex items-center gap-3 px-4 py-3 rounded-lg transition-colors ${\n                      isActive\n                        ? 'bg-zinc-900 text-white'\n                        : 'text-zinc-600 hover:bg-zinc-100'\n                    }`}\n                  >\n                    <span className=\"text-xl\">{item.icon}</span>\n                    <span className=\"font-medium\">{item.label}</span>\n                  </a>\n                );\n              })}\n            </nav>\n          </aside>\n\n          {/* Mobile Bottom Navigation */}\n          <div className=\"lg:hidden fixed bottom-0 left-0 right-0 bg-white border-t border-zinc-200 z-50\">\n            <nav className=\"flex justify-around py-2\">\n              {navItems.map((item) => {\n                const isActive = pathname === item.href;\n                return (\n                  <a\n                    key={item.href}\n                    href={item.href}\n                    className={`flex flex-col items-center gap-1 px-3 py-2 rounded-lg transition-colors ${\n                      isActive ? 'text-zinc-900' : 'text-zinc-400'\n                    }`}\n                  >\n                    <span className=\"text-xl\">{item.icon}</span>\n                    <span className=\"text-xs font-medium\">{item.label}</span>\n                  </a>\n                );\n              })}\n            </nav>\n          </div>\n\n          {/* Main Content */}\n          <main className=\"flex-1 p-4 lg:p-8 pb-20 lg:pb-8\">\n            {children}\n          </main>\n        </div>\n      )}\n\n      {/* Login page renders directly without sidebar */}\n      {!showSidebar && pathname === '/dealer/login' && (\n        <main>{children}</main>\n      )}\n    </div>\n  );\n}\n"],"names":[],"mappings":"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"}